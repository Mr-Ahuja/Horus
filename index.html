<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Horus — Video Room</title>
  <script type='text/javascript' src='scaledrone.min.js'></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='28' fill='%232e8cff'/%3E%3Ccircle cx='32' cy='32' r='12' fill='white'/%3E%3Ccircle cx='32' cy='32' r='6' fill='%230b0f14'/%3E%3C/svg%3E">
  <script>window.ENV = window.ENV || {};</script>
  <script src="env.js" defer></script>
  <style>
    :root {
      --bg: #0b0f14;
      --panel: #121821;
      --text: #e6eef8;
      --muted: #95a3b8;
      --accent: #2e8cff;
      --danger: #ff4d4f;
      --success: #29c26a;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; background: var(--bg); color: var(--text); font-family: Roboto, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    .app {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      display: grid;
      grid-template-rows: auto 1fr auto;
    }
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 14px;
      background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0));
      z-index: 3;
    }
    .room {
      display: flex; gap: 10px; align-items: center;
      font-weight: 500;
    }
    .badge { padding: 4px 10px; border-radius: 999px; font-size: 12px; background: var(--panel); color: var(--muted); }
    .status { padding: 4px 10px; border-radius: 999px; font-size: 12px; background: var(--panel); color: var(--muted); }
    .status.ok { color: var(--success); }
    .status.warn { color: #f5a524; }
    .status.err { color: var(--danger); }
    .btn { cursor: pointer; border: 1px solid #1e2733; background: #0f151d; color: var(--text); padding: 8px 12px; border-radius: 10px; font-size: 14px; transition: 0.15s ease; display: inline-flex; align-items: center; gap: 6px; }
    .btn:hover { border-color: #2a3545; background: #131b26; }
    .btn.primary { background: var(--accent); border-color: var(--accent); color: white; }
    .btn.danger { background: var(--danger); border-color: var(--danger); color: white; }
    .videos { position: relative; width: 100%; height: 100%; background: #000; padding: 10px; overflow: hidden; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 10px; height: 100%; align-content: start; }
    .tile { position: relative; border-radius: 12px; overflow: hidden; background: #0a0a0a; border: 1px solid #1c2430; aspect-ratio: 1.618/1; }
    .tile video { width: 100%; height: 100%; object-fit: cover; display: block; background: #000; }
    .label { position: absolute; left: 8px; bottom: 8px; background: rgba(0,0,0,0.55); padding: 2px 6px; border-radius: 6px; font-size: 12px; color: #d9e1ee; }
    .controls {
      display: flex; gap: 8px; align-items: center; justify-content: center; padding: 10px; z-index: 3; background: linear-gradient(0deg, rgba(0,0,0,0.35), rgba(0,0,0,0));
    }
    .selects { display: flex; gap: 8px; align-items: center; }
    select { background: #0f151d; color: var(--text); border: 1px solid #1e2733; border-radius: 8px; padding: 6px 10px; }
    .helper { position: absolute; left: 50%; top: 50%; transform: translate(-50%,-50%); text-align: center; color: var(--muted); font-size: 14px; z-index: 1; }
    @media (max-width: 640px) {
      .selects { display: none; }
    }

    /* Landing (constellations) */
    .landing { position: fixed; inset: 0; background: radial-gradient(1200px 800px at 70% 20%, #152030 0%, #0b0f14 60%); display: grid; place-items: center; z-index: 10; }
    .landing.hidden { display: none; }
    #stars { position: absolute; inset: 0; width: 100%; height: 100%; }
    .hero { position: relative; z-index: 1; display: flex; flex-direction: column; align-items: center; gap: 16px; text-align: center; padding: 24px; background: rgba(10,14,20,0.45); border: 1px solid #1f2a38; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.35); }
    .hero h1 { margin: 0; font-size: 28px; letter-spacing: 0.5px; }
    .cta { display: flex; gap: 8px; }
    .btn.mellange { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); color: #0b0f14; border-color: #ffffff22; }
    .btn.ghost { background: transparent; border-color: #ffffff33; color: var(--text); }
    .join { display: flex; gap: 8px; align-items: center; }
    .join input { width: 240px; padding: 10px 12px; border-radius: 10px; border: 1px solid #1e2733; background: #0f151d; color: var(--text); }
  </style>
</head>

<body>
  <div id="landing" class="landing">
    <canvas id="stars"></canvas>
    <div class="hero">
      <h1>Horus Calls</h1>
      <div class="cta">
        <button id="startRoomBtn" class="btn mellange"><span class="material-icons" style="font-size:18px">auto_awesome</span>Start Room</button>
        <button id="copyLinkLanding" class="btn ghost"><span class="material-icons" style="font-size:18px">link</span>Copy Current Link</button>
      </div>
      <div class="join">
        <input id="roomInput" placeholder="Enter room code or URL" />
        <button id="joinBtn" class="btn primary">Join</button>
      </div>
    </div>
  </div>
  <div class="app">
    <div class="topbar">
      <div class="room">
        <span class="badge">Room</span>
        <span id="roomId"></span>
        <span id="connStatus" class="status">initializing…</span>
        <span class="badge" id="participants">1</span>
      </div>
      <div class="actions">
        <button id="copyLinkBtn" class="btn"><span class="material-icons" style="font-size:18px">link</span>Copy Link</button>
      </div>
    </div>
    <div class="videos">
      <div class="helper">Share the link to invite people. Tiles appear as they join.</div>
      <div id="grid" class="grid">
        <div class="tile" id="tile-self">
          <video id="localVideo" autoplay muted playsinline></video>
          <div class="label">You</div>
        </div>
      </div>
    </div>
    <div class="controls">
      <button id="toggleMicBtn" class="btn" aria-pressed="false"><span class="material-icons" style="font-size:18px">mic</span><span>Mute</span></button>
      <button id="toggleCamBtn" class="btn" aria-pressed="false"><span class="material-icons" style="font-size:18px">videocam</span><span>Stop</span></button>
      <button id="hangupBtn" class="btn danger"><span class="material-icons" style="font-size:18px">call_end</span><span>End</span></button>
      <div class="selects">
        <label for="audioIn">Mic</label>
        <select id="audioIn"></select>
        <label for="videoIn">Camera</label>
        <select id="videoIn"></select>
      </div>
    </div>
  </div>
  <script src="script.js"></script>
</body>

</html>
